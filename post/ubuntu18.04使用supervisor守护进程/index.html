<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="问题背景 最近部署了一个python server在我买的服务器上，想让他一直运行，否则一断开服务器的话，python server提供的API就访问不了了。\n于是想着用supervisor来做守护进程, 本文就是记录supervisor 的安装、配置、使用技巧，并设置如何supervisor开机自动启动\n机器环境 Ubuntu版本：18.04\nUbuntu用户：root\nUbuntu安装supervisor apt install supervisor Ubuntu配置supervisor 安装完成后，会生成一个默认的配置文件/etc/supervisor/supervisord.conf， 这个默认配置里面也会load所有在conf.d目录下的配置\nroot@test:/etc/supervisor# tree . |-- conf.d | `-- we.conf `-- supervisord.conf 1 directory, 2 files supervisord.conf这个默认配置会load所有在conf.d目录下的配置，所以我们接下来在conf.d目录下新建一个我们自己的配置\ntouch /etc/supervisor/conf.d/we.conf 参照默认配置文件supervisord.conf里的内容改改，配置内容如下\n[program:we] directory=/home/test/ command=sh we.sh autostart=true autorestart=true startretries=10 redirect_stderr=true stdout_logfile=/home/test/out.log 具体也可参照官方给的详细文档： http://supervisord.org/configuration.html\n检查supervisor的状态 1、检查supervisor的状态\nps aux | grep supervisor root@test:/etc/supervisor# ps aux | grep supervisor root 2551 0.0 2.0 65580 21508 ? Ss 12:39 0:09 /usr/bin/python /usr/bin/supervisord -n -c /etc/supervisor/supervisord.conf root 7720 0.0 0.1 13116 1044 pts/0 S+ 16:46 0:00 grep --color=auto supervisor 当看到如上对应的进程，就说明supervisor启动是成功的。\n"><title>Ubuntu18.04使用supervisor守护进程</title>
<link rel=canonical href=http://example.org/post/ubuntu18.04%E4%BD%BF%E7%94%A8supervisor%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="Ubuntu18.04使用supervisor守护进程"><meta property='og:description' content="问题背景 最近部署了一个python server在我买的服务器上，想让他一直运行，否则一断开服务器的话，python server提供的API就访问不了了。\n于是想着用supervisor来做守护进程, 本文就是记录supervisor 的安装、配置、使用技巧，并设置如何supervisor开机自动启动\n机器环境 Ubuntu版本：18.04\nUbuntu用户：root\nUbuntu安装supervisor apt install supervisor Ubuntu配置supervisor 安装完成后，会生成一个默认的配置文件/etc/supervisor/supervisord.conf， 这个默认配置里面也会load所有在conf.d目录下的配置\nroot@test:/etc/supervisor# tree . |-- conf.d | `-- we.conf `-- supervisord.conf 1 directory, 2 files supervisord.conf这个默认配置会load所有在conf.d目录下的配置，所以我们接下来在conf.d目录下新建一个我们自己的配置\ntouch /etc/supervisor/conf.d/we.conf 参照默认配置文件supervisord.conf里的内容改改，配置内容如下\n[program:we] directory=/home/test/ command=sh we.sh autostart=true autorestart=true startretries=10 redirect_stderr=true stdout_logfile=/home/test/out.log 具体也可参照官方给的详细文档： http://supervisord.org/configuration.html\n检查supervisor的状态 1、检查supervisor的状态\nps aux | grep supervisor root@test:/etc/supervisor# ps aux | grep supervisor root 2551 0.0 2.0 65580 21508 ? Ss 12:39 0:09 /usr/bin/python /usr/bin/supervisord -n -c /etc/supervisor/supervisord.conf root 7720 0.0 0.1 13116 1044 pts/0 S+ 16:46 0:00 grep --color=auto supervisor 当看到如上对应的进程，就说明supervisor启动是成功的。\n"><meta property='og:url' content='http://example.org/post/ubuntu18.04%E4%BD%BF%E7%94%A8supervisor%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B/'><meta property='og:site_name' content='My New Hugo Site'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='linux'><meta property='article:published_time' content='2022-08-07T15:54:02+08:00'><meta property='article:modified_time' content='2022-08-07T15:54:02+08:00'><meta name=twitter:title content="Ubuntu18.04使用supervisor守护进程"><meta name=twitter:description content="问题背景 最近部署了一个python server在我买的服务器上，想让他一直运行，否则一断开服务器的话，python server提供的API就访问不了了。\n于是想着用supervisor来做守护进程, 本文就是记录supervisor 的安装、配置、使用技巧，并设置如何supervisor开机自动启动\n机器环境 Ubuntu版本：18.04\nUbuntu用户：root\nUbuntu安装supervisor apt install supervisor Ubuntu配置supervisor 安装完成后，会生成一个默认的配置文件/etc/supervisor/supervisord.conf， 这个默认配置里面也会load所有在conf.d目录下的配置\nroot@test:/etc/supervisor# tree . |-- conf.d | `-- we.conf `-- supervisord.conf 1 directory, 2 files supervisord.conf这个默认配置会load所有在conf.d目录下的配置，所以我们接下来在conf.d目录下新建一个我们自己的配置\ntouch /etc/supervisor/conf.d/we.conf 参照默认配置文件supervisord.conf里的内容改改，配置内容如下\n[program:we] directory=/home/test/ command=sh we.sh autostart=true autorestart=true startretries=10 redirect_stderr=true stdout_logfile=/home/test/out.log 具体也可参照官方给的详细文档： http://supervisord.org/configuration.html\n检查supervisor的状态 1、检查supervisor的状态\nps aux | grep supervisor root@test:/etc/supervisor# ps aux | grep supervisor root 2551 0.0 2.0 65580 21508 ? Ss 12:39 0:09 /usr/bin/python /usr/bin/supervisord -n -c /etc/supervisor/supervisord.conf root 7720 0.0 0.1 13116 1044 pts/0 S+ 16:46 0:00 grep --color=auto supervisor 当看到如上对应的进程，就说明supervisor启动是成功的。\n"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column compact"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu13739649187745961479.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>My New Hugo Site</a></h1><h2 class=site-description></h2></div></header><ol class=menu id=main-menu><li><a href=/about/><span>About</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E6%9D%82%E8%AE%B0/>杂记</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/ubuntu18.04%E4%BD%BF%E7%94%A8supervisor%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B/>Ubuntu18.04使用supervisor守护进程</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Aug 07, 2022</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>4 minute read</time></div></footer></div></header><section class=article-content><h3 id=问题背景>问题背景</h3><p>最近部署了一个python server在我买的服务器上，想让他一直运行，否则一断开服务器的话，python server提供的API就访问不了了。</p><p>于是想着用supervisor来做守护进程, 本文就是记录supervisor 的安装、配置、使用技巧，并设置如何supervisor开机自动启动</p><h3 id=机器环境>机器环境</h3><p>Ubuntu版本：18.04</p><p>Ubuntu用户：root</p><h3 id=ubuntu安装supervisor>Ubuntu安装supervisor</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>apt install supervisor
</span></span></code></pre></div><h3 id=ubuntu配置supervisor>Ubuntu配置supervisor</h3><p>安装完成后，会生成一个默认的配置文件/etc/supervisor/supervisord.conf， 这个默认配置里面也会load所有在conf.d目录下的配置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>root@test:/etc/supervisor# tree
</span></span><span style=display:flex><span>.
</span></span><span style=display:flex><span>|-- conf.d
</span></span><span style=display:flex><span>|   <span style=color:#e6db74>`</span>-- we.conf
</span></span><span style=display:flex><span><span style=color:#e6db74>`</span>-- supervisord.conf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> directory, <span style=color:#ae81ff>2</span> files
</span></span></code></pre></div><p>supervisord.conf这个默认配置会load所有在conf.d目录下的配置，所以我们接下来在conf.d目录下新建一个我们自己的配置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>touch /etc/supervisor/conf.d/we.conf
</span></span></code></pre></div><p>参照默认配置文件supervisord.conf里的内容改改，配置内容如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>program:we<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>directory<span style=color:#f92672>=</span>/home/test/
</span></span><span style=display:flex><span>command<span style=color:#f92672>=</span>sh we.sh
</span></span><span style=display:flex><span>autostart<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>autorestart<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>startretries<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>redirect_stderr<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>stdout_logfile<span style=color:#f92672>=</span>/home/test/out.log
</span></span></code></pre></div><p>具体也可参照官方给的详细文档： <a class=link href=http://supervisord.org/configuration.html target=_blank rel=noopener>http://supervisord.org/configuration.html</a></p><h3 id=检查supervisor的状态>检查supervisor的状态</h3><p>1、检查supervisor的状态</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>ps aux | grep supervisor
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>root@test:/etc/supervisor# ps aux | grep supervisor
</span></span><span style=display:flex><span>root      <span style=color:#ae81ff>2551</span>  0.0  2.0  <span style=color:#ae81ff>65580</span> <span style=color:#ae81ff>21508</span> ?        Ss   12:39   0:09 /usr/bin/python /usr/bin/supervisord -n -c /etc/supervisor/supervisord.conf
</span></span><span style=display:flex><span>root      <span style=color:#ae81ff>7720</span>  0.0  0.1  <span style=color:#ae81ff>13116</span>  <span style=color:#ae81ff>1044</span> pts/0    S+   16:46   0:00 grep --color<span style=color:#f92672>=</span>auto supervisor
</span></span></code></pre></div><p>当看到如上对应的进程，就说明supervisor启动是成功的。</p><p>2、检查守护的进程的状态</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>root@test:/etc/supervisor# supervisorctl
</span></span><span style=display:flex><span>we                        RUNNING   pid 2603, uptime 4:05:59
</span></span></code></pre></div><p>我们就可以看到我们配置的守护进程的状态，如果不在运行，会有相应的错误信息，可以去刚才配置的log目录查看日志：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>less /home/test/out.log
</span></span></code></pre></div><h3 id=supervisorctl-常用命令>supervisorctl 常用命令</h3><div class=table-wrapper><table><thead><tr><th style=text-align:left>command</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>supervisorctl stop program_name</td><td style=text-align:left>停止某个进程</td></tr><tr><td style=text-align:left>supervisorctl start program_name</td><td style=text-align:left>启动某个进程</td></tr><tr><td style=text-align:left>supervisorctl restart program_name</td><td style=text-align:left>重启某个进程</td></tr><tr><td style=text-align:left>supervisorctl stop all</td><td style=text-align:left>停止全部进程</td></tr><tr><td style=text-align:left>supervisorctl reload</td><td style=text-align:left>载入最新的配置文件，停止原有进程并按新的配置启动、管理所有进程</td></tr><tr><td style=text-align:left>supervisorctl update</td><td style=text-align:left>根据最新的配置文件，启动新配置或有改动的进程，配置没有改动的进程不会受影响而重启</td></tr></tbody></table></div><h3 id=设置supervisor开机启动>设置supervisor开机启动</h3><p>如果使用apt安装的，一般来说会自动设置好开机启动，但是如果你重启之后发现没有开机自动启动，可以按照下面的方法配置。</p><p>把下面的命令写进 rc.local 即可：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>/usr/bin/supervisord
</span></span></code></pre></div><h3 id=mac设置supervisor>mac设置supervisor</h3><p>1、brew 安装supervisor</p><p>如果你还没有安装brew，这里使他们的官网https://brew.sh/，安装brew的命令：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>/bin/bash -c <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>brew install supervisor
</span></span><span style=display:flex><span>brew services restart supervisor
</span></span></code></pre></div><p>2、配置文件，先打开默认配置文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>vim /usr/local/etc/supervisord.conf
</span></span></code></pre></div><p>3、这是它的默认配置：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>;<span style=color:#f92672>[</span>program:theprogramname<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>;command<span style=color:#f92672>=</span>/bin/cat              ; the program <span style=color:#f92672>(</span>relative uses PATH, can take args<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;process_name<span style=color:#f92672>=</span>%<span style=color:#f92672>(</span>program_name<span style=color:#f92672>)</span>s ; process_name expr <span style=color:#f92672>(</span>default %<span style=color:#f92672>(</span>program_name<span style=color:#f92672>)</span>s<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;numprocs<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>                    ; number of processes copies to start <span style=color:#f92672>(</span>def 1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;directory<span style=color:#f92672>=</span>/tmp                ; directory to cwd to before exec <span style=color:#f92672>(</span>def no cwd<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;umask<span style=color:#f92672>=</span><span style=color:#ae81ff>022</span>                     ; umask <span style=color:#66d9ef>for</span> process <span style=color:#f92672>(</span>default None<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;priority<span style=color:#f92672>=</span><span style=color:#ae81ff>999</span>                  ; the relative start priority <span style=color:#f92672>(</span>default 999<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;autostart<span style=color:#f92672>=</span>true                ; start at supervisord start <span style=color:#f92672>(</span>default: true<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;startsecs<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>                   ; <span style=color:#75715e># of secs prog must stay up to be running (def. 1)</span>
</span></span><span style=display:flex><span>;startretries<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>                ; max <span style=color:#75715e># of serial start failures when starting (default 3)</span>
</span></span><span style=display:flex><span>;autorestart<span style=color:#f92672>=</span>unexpected        ; when to restart <span style=color:#66d9ef>if</span> exited after running <span style=color:#f92672>(</span>def: unexpected<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;exitcodes<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>                   ; <span style=color:#e6db74>&#39;expected&#39;</span> exit codes used with autorestart <span style=color:#f92672>(</span>default 0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;stopsignal<span style=color:#f92672>=</span>QUIT               ; signal used to kill process <span style=color:#f92672>(</span>default TERM<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;stopwaitsecs<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>               ; max num secs to wait b4 SIGKILL <span style=color:#f92672>(</span>default 10<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;stopasgroup<span style=color:#f92672>=</span>false             ; send stop signal to the UNIX process group <span style=color:#f92672>(</span>default false<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;killasgroup<span style=color:#f92672>=</span>false             ; SIGKILL the UNIX process group <span style=color:#f92672>(</span>def false<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;user<span style=color:#f92672>=</span>chrism                   ; setuid to this UNIX account to run the program
</span></span><span style=display:flex><span>;redirect_stderr<span style=color:#f92672>=</span>true          ; redirect proc stderr to stdout <span style=color:#f92672>(</span>default false<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;stdout_logfile<span style=color:#f92672>=</span>/a/path        ; stdout log path, NONE <span style=color:#66d9ef>for</span> none; default AUTO
</span></span><span style=display:flex><span>;stdout_logfile_maxbytes<span style=color:#f92672>=</span>1MB   ; max <span style=color:#75715e># logfile bytes b4 rotation (default 50MB)</span>
</span></span><span style=display:flex><span>;stdout_logfile_backups<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>     ; <span style=color:#75715e># of stdout logfile backups (0 means none, default 10)</span>
</span></span><span style=display:flex><span>;stdout_capture_maxbytes<span style=color:#f92672>=</span>1MB   ; number of bytes in <span style=color:#e6db74>&#39;capturemode&#39;</span> <span style=color:#f92672>(</span>default 0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;stdout_events_enabled<span style=color:#f92672>=</span>false   ; emit events on stdout writes <span style=color:#f92672>(</span>default false<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;stdout_syslog<span style=color:#f92672>=</span>false           ; send stdout to syslog with process name <span style=color:#f92672>(</span>default false<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;stderr_logfile<span style=color:#f92672>=</span>/a/path        ; stderr log path, NONE <span style=color:#66d9ef>for</span> none; default AUTO
</span></span><span style=display:flex><span>;stderr_logfile_maxbytes<span style=color:#f92672>=</span>1MB   ; max <span style=color:#75715e># logfile bytes b4 rotation (default 50MB)</span>
</span></span><span style=display:flex><span>;stderr_logfile_backups<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>     ; <span style=color:#75715e># of stderr logfile backups (0 means none, default 10)</span>
</span></span><span style=display:flex><span>;stderr_capture_maxbytes<span style=color:#f92672>=</span>1MB   ; number of bytes in <span style=color:#e6db74>&#39;capturemode&#39;</span> <span style=color:#f92672>(</span>default 0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;stderr_events_enabled<span style=color:#f92672>=</span>false   ; emit events on stderr writes <span style=color:#f92672>(</span>default false<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;stderr_syslog<span style=color:#f92672>=</span>false           ; send stderr to syslog with process name <span style=color:#f92672>(</span>default false<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;environment<span style=color:#f92672>=</span>A<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1&#34;</span>,B<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;2&#34;</span>       ; process environment additions <span style=color:#f92672>(</span>def no adds<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>;serverurl<span style=color:#f92672>=</span>AUTO                ; override serverurl computation <span style=color:#f92672>(</span>childutils<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>4、我们可以复制一份，改一改，改成我们自己想要启动程序的配置，比如我想要启动gos</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>program:gitgos<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>command<span style=color:#f92672>=</span>/Users/yzw/Downloads/gitzub/gogs/gogs web -p <span style=color:#ae81ff>3008</span>              ; the program <span style=color:#f92672>(</span>relative uses PATH, can take args<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>process_name<span style=color:#f92672>=</span>%<span style=color:#f92672>(</span>program_name<span style=color:#f92672>)</span>s ; process_name expr <span style=color:#f92672>(</span>default %<span style=color:#f92672>(</span>program_name<span style=color:#f92672>)</span>s<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>numprocs<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>                    ; number of processes copies to start <span style=color:#f92672>(</span>def 1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>directory<span style=color:#f92672>=</span>/Users/yzw/Downloads/gitzub/gogs/                ; directory to cwd to before exec <span style=color:#f92672>(</span>def no cwd<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>autostart<span style=color:#f92672>=</span>true                ; start at supervisord start <span style=color:#f92672>(</span>default: true<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>startsecs<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>                   ; <span style=color:#75715e># of secs prog must stay up to be running (def. 1)</span>
</span></span><span style=display:flex><span>startretries<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>                ; max <span style=color:#75715e># of serial start failures when starting (default 3)</span>
</span></span><span style=display:flex><span>; stopasgroup<span style=color:#f92672>=</span>true             ; send stop signal to the UNIX process group <span style=color:#f92672>(</span>default false<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>; killasgroup<span style=color:#f92672>=</span>true             ; SIGKILL the UNIX process group <span style=color:#f92672>(</span>def false<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>user<span style=color:#f92672>=</span>zhiwei                   ; setuid to this UNIX account to run the program
</span></span><span style=display:flex><span>redirect_stderr<span style=color:#f92672>=</span>true          ; redirect proc stderr to stdout <span style=color:#f92672>(</span>default false<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>stdout_logfile<span style=color:#f92672>=</span>/Users/zhiwei/Downloads/gitzub/gogs/log/data.log        ; stdout log path, NONE <span style=color:#66d9ef>for</span> none; default AUTO
</span></span><span style=display:flex><span>stdout_logfile_maxbytes<span style=color:#f92672>=</span>10MB   ; max <span style=color:#75715e># logfile bytes b4 rotation (default 50MB)</span>
</span></span><span style=display:flex><span>stdout_logfile_backups<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>     ; <span style=color:#75715e># of stdout logfile backups (0 means none, default 10)</span>
</span></span><span style=display:flex><span>stdout_capture_maxbytes<span style=color:#f92672>=</span>10MB   ; number of bytes in <span style=color:#e6db74>&#39;capturemode&#39;</span> <span style=color:#f92672>(</span>default 0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>stderr_logfile<span style=color:#f92672>=</span>/Users/zhiwei/Downloads/gitzub/gogs/log/error.log       ; stderr log path, NONE <span style=color:#66d9ef>for</span> none; default AUTO
</span></span><span style=display:flex><span>stderr_logfile_maxbytes<span style=color:#f92672>=</span>10MB   ; max <span style=color:#75715e># logfile bytes b4 rotation (default 50MB)</span>
</span></span><span style=display:flex><span>stderr_logfile_backups<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>     ; <span style=color:#75715e># of stderr logfile backups (0 means none, default 10)</span>
</span></span><span style=display:flex><span>stderr_capture_maxbytes<span style=color:#f92672>=</span>10MB   ; number of bytes in <span style=color:#e6db74>&#39;capturemode&#39;</span> <span style=color:#f92672>(</span>default 0<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>5、然后再执行命令重新加载下配置，使得新的配置生效， 然后再执行supervisorctl命令，查看gos是否启动成功，状态为RUNNING则成功启动。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>supervisorctl reload
</span></span><span style=display:flex><span>➜ supervisorctl
</span></span><span style=display:flex><span>gitgos                           RUNNING   pid 44926, uptime 0:41:54
</span></span><span style=display:flex><span>supervisor&gt;
</span></span></code></pre></div></section><footer class=article-footer><section class=article-tags><a href=/tags/linux/>Linux</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/post/wget%E7%94%A8%E6%B3%95/><div class=article-details><h2 class=article-title>Wget用法</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2024 My New Hugo Site</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.27.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>